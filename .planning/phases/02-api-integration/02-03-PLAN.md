---
phase: 02-api-integration
plan: 03
type: execute
depends_on: ["02-02"]
files_modified: [src/cli/commands/status.ts, src/cli/commands/config.ts, src/cli/commands/index.ts]
---

<objective>
CLI status 명령어 실제 구현 및 config 명령어 추가

Purpose: status 명령어가 실제로 n8n 인스턴스에 연결하여 상태를 확인하고, config 명령어로 설정을 관리한다.
Output: 실제 연결 상태 확인 CLI, 설정 관리 CLI
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/02-api-integration/02-02-SUMMARY.md
@src/cli/commands/status.ts

**Tech stack available:**
- Commander.js CLI 프레임워크
- 연결 관리: testConnection, connectToEnvironment
- 설정 시스템: loadConfig, configExists, findConfigPath

**Project constraints:**
- 설정 파일 없을 때 친절한 안내 메시지
- 연결 실패 시 디버깅 가능한 정보 제공
</context>

<tasks>

<task type="auto">
  <name>Task 1: status 명령어 실제 구현</name>
  <files>src/cli/commands/status.ts</files>
  <action>
src/cli/commands/status.ts 수정:

기존 placeholder 메시지를 실제 연결 테스트로 교체:

1. 설정 파일 존재 확인 (configExists)
   - 없으면: 친절한 안내 메시지 + config.example.yaml 복사 안내

2. 있으면: connectToEnvironment() 호출
   - --env 옵션으로 특정 환경 지정 가능

3. 결과 출력:
   - 연결 성공:
     ```
     ✓ Connected to n8n

       Environment: dev
       URL: http://localhost:5678
       Latency: 45ms
     ```
   - 연결 실패:
     ```
     ✗ Connection failed

       Environment: dev
       URL: http://localhost:5678
       Error: Connection refused

     Troubleshooting:
       1. Check if n8n is running
       2. Verify the URL in config
       3. Check your API key
     ```

Commander 옵션 추가:
- -e, --env <name>: 특정 환경 지정
  </action>
  <verify>npm run build && node dist/index.js status --help</verify>
  <done>status 명령어가 실제로 n8n 연결 상태 확인</done>
</task>

<task type="auto">
  <name>Task 2: config 명령어 추가</name>
  <files>src/cli/commands/config.ts</files>
  <action>
src/cli/commands/config.ts 생성:

registerConfigCommand(program: Command) 함수:

하위 명령어:
1. config show
   - 현재 설정 파일 경로 및 내용 표시
   - 환경 목록 표시
   - API Key는 마스킹 (앞 4자리만 표시)

2. config path
   - 설정 파일 검색 경로 표시
   - 현재 사용 중인 설정 파일 경로 표시

3. config init
   - config.example.yaml을 n8n-wfm.config.yaml로 복사
   - 이미 있으면 덮어쓰기 확인

출력 형식:
```
Configuration
─────────────
File: ./n8n-wfm.config.yaml
Version: 1
Current Environment: dev

Environments:
  • dev (current)
    URL: http://localhost:5678
    API Key: n8n_****
  • staging
    URL: https://n8n-staging.example.com
    API Key: n8n_****
  • prod
    URL: https://n8n.example.com
    API Key: n8n_****
```
  </action>
  <verify>npm run build && node dist/index.js config --help</verify>
  <done>config 명령어 및 하위 명령어 구현됨</done>
</task>

<task type="auto">
  <name>Task 3: 명령어 등록 업데이트</name>
  <files>src/cli/commands/index.ts</files>
  <action>
src/cli/commands/index.ts 수정:

1. config 명령어 import 추가:
   import { registerConfigCommand } from './config.js';

2. registerCommands 함수에서 config 명령어 등록:
   registerConfigCommand(program);

명령어 순서:
- status
- config
- (향후 추가: backup, restore, deploy 등)
  </action>
  <verify>npm run build && node dist/index.js --help</verify>
  <done>config 명령어가 CLI에 등록됨</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npm run build` 성공
- [ ] `node dist/index.js status` - 설정 없을 때 안내 메시지
- [ ] `node dist/index.js config show` - 설정 내용 표시
- [ ] `node dist/index.js config path` - 검색 경로 표시
- [ ] `node dist/index.js config init` - 설정 파일 초기화
- [ ] `node dist/index.js --help` - 모든 명령어 표시
</verification>

<success_criteria>
- 모든 태스크 완료
- status 명령어 실제 연결 테스트
- config 명령어로 설정 관리
- Phase 2 완료, Phase 3 준비됨
</success_criteria>

<output>
완료 후 `.planning/phases/02-api-integration/02-03-SUMMARY.md` 생성

Phase 2 완료 시 SUMMARY에 "Phase 2 complete, ready for Phase 3" 명시
</output>
