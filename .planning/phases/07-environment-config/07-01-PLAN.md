---
phase: 07-environment-config
plan: 01
type: execute
depends_on: []
files_modified: [src/types/config.ts, src/config/environment.ts, src/config/index.ts, config.example.yaml]
---

<objective>
환경별 설정 파일 구조를 개선하고 다중 환경 관리 유틸리티를 구현합니다.

Purpose: 개발/스테이징/프로덕션 환경 간 설정을 체계적으로 분리하고 관리
Output: 환경별 설정 관리 모듈 및 개선된 설정 타입
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-plan.md
./07-01-SUMMARY.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md

# 참조 파일:
@src/types/config.ts
@src/config/index.ts
@src/config/schema.ts

**기술 스택:**
- TypeScript 5.x, ES Modules
- YAML 설정 파일 (yaml 라이브러리)

**현재 구조 분석:**
- Config 인터페이스에 environments 배열 존재
- currentEnvironment로 활성 환경 지정
- 환경별 n8n URL/apiKey 설정 지원
- 환경변수 치환 (${VAR_NAME}) 지원됨

**결정 사항:**
- 기존 Config 타입 구조 유지하며 확장
- 환경별 설정 파일 분리 옵션 추가 (선택적)
- 환경 목록 조회 및 유효성 검사 유틸리티 추가
</context>

<tasks>

<task type="auto">
  <name>Task 1: 환경 설정 타입 확장</name>
  <files>src/types/config.ts</files>
  <action>
src/types/config.ts에 환경 관리용 타입 추가:

1. EnvironmentConfig 확장:
   - description?: string - 환경 설명 (예: "개발 서버", "운영 서버")
   - tags?: string[] - 환경 태그 (예: ["local", "test"])

2. 새 타입 추가:
   - EnvironmentSummary: name, url, isDefault, description
   - EnvironmentValidation: name, isValid, errors (연결 테스트 결과)
  </action>
  <verify>npm run build 성공</verify>
  <done>환경 관리 타입 확장 완료</done>
</task>

<task type="auto">
  <name>Task 2: 환경 관리 유틸리티 구현</name>
  <files>src/config/environment.ts</files>
  <action>
src/config/environment.ts 생성:

1. listEnvironments(config): EnvironmentSummary[]
   - 모든 환경 요약 목록 반환
   - 현재 환경 표시 포함

2. hasEnvironment(config, name): boolean
   - 환경 존재 여부 확인

3. getDefaultEnvironment(config): EnvironmentConfig | null
   - isDefault: true인 환경 반환

4. getEnvironmentNames(config): string[]
   - 환경 이름 목록만 반환

5. isCurrentEnvironment(config, name): boolean
   - 현재 활성 환경인지 확인
  </action>
  <verify>npm run build 성공</verify>
  <done>환경 관리 유틸리티 구현</done>
</task>

<task type="auto">
  <name>Task 3: config 모듈 인덱스 업데이트 및 예제 파일 개선</name>
  <files>src/config/index.ts, config.example.yaml</files>
  <action>
1. src/config/index.ts 수정:
   - environment.ts에서 함수 재내보내기:
     - listEnvironments
     - hasEnvironment
     - getDefaultEnvironment
     - getEnvironmentNames
     - isCurrentEnvironment
   - 새 타입 재내보내기:
     - EnvironmentSummary
     - EnvironmentValidation

2. config.example.yaml 개선:
   - description 필드 예제 추가
   - tags 필드 예제 추가
   - 환경 설정 주석 보강

3. 빌드 검증
  </action>
  <verify>
npm run build 성공
node dist/index.js config show --help 정상 출력
  </verify>
  <done>환경 설정 구조 개선 완료</done>
</task>

</tasks>

<verification>
- [ ] `npm run build` 성공
- [ ] EnvironmentSummary, EnvironmentValidation 타입 정의됨
- [ ] listEnvironments, hasEnvironment 등 유틸리티 함수 동작
- [ ] config.example.yaml에 새 필드 예제 포함
</verification>

<success_criteria>
- 환경 관리 타입 확장됨
- 환경 목록 조회 유틸리티 함수 구현됨
- 기존 기능과 하위 호환성 유지됨
- 빌드 성공
</success_criteria>

<output>
완료 후 `.planning/phases/07-environment-config/07-01-SUMMARY.md` 생성
</output>
