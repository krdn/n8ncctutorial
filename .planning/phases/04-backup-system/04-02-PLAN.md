# Plan 04-02: 수동 백업 명령어

## Overview
CLI에서 수동으로 워크플로우를 백업하는 명령어를 구현합니다. 전체 백업, 선택적 백업, 활성 워크플로우만 백업하는 옵션을 제공합니다.

## Dependencies
- 04-01 완료 (백업 저장소 구조)

## Tasks

<task id="1">
<title>백업 실행 모듈 구현</title>
<file>src/backup/backup.ts</file>
<action>create</action>
<description>
백업 실행 핵심 로직:
- createBackup(client, options): 전체 워크플로우 백업 수행
  - 백업 ID 생성
  - 백업 디렉토리 생성
  - exportAllWorkflows 활용하여 워크플로우 내보내기
  - 매니페스트 파일 생성 및 저장
  - BackupResult 반환
- createSelectiveBackup(client, workflowIds, options): 선택적 워크플로우 백업
</description>
</task>

<task id="2">
<title>백업 CLI 명령어 구현</title>
<file>src/cli/commands/backup.ts</file>
<action>create</action>
<description>
backup 명령어 구현:
- `n8n-wfm backup` - 전체 워크플로우 백업
- 옵션:
  - -o, --output <dir>: 백업 저장 디렉토리 (기본: 설정값 또는 ./backups)
  - -e, --env <name>: 환경 이름
  - -c, --config <path>: 설정 파일 경로
  - --keep-credentials: credentials 유지
  - --active-only: 활성 워크플로우만 백업
  - --ids <ids>: 특정 워크플로우 ID들만 백업 (콤마 구분)
- 진행 상황 표시 (ProgressCallback 활용)
- 완료 후 요약 정보 출력
</description>
</task>

<task id="3">
<title>백업 모듈 인덱스 업데이트</title>
<file>src/backup/index.ts</file>
<action>modify</action>
<description>
backup.ts 함수들 재내보내기 추가:
- createBackup, createSelectiveBackup
</description>
</task>

<task id="4">
<title>CLI 명령어 등록</title>
<file>src/cli/commands/index.ts</file>
<action>modify</action>
<description>
registerBackupCommand 함수 등록하여 backup 명령어 활성화
</description>
</task>

<task id="5">
<title>빌드 및 CLI 검증</title>
<file>package.json</file>
<action>verify</action>
<description>
- npm run build 실행
- node dist/index.js backup --help 실행하여 옵션 확인
</description>
</task>

## Verification
- [ ] `npm run build` 성공
- [ ] `node dist/index.js backup --help` 정상 출력
- [ ] createBackup 함수 구현 완료
- [ ] 진행 상황 콜백 연동

## Notes
- bulk.ts의 exportAllWorkflows 함수와 ProgressCallback 활용
- 백업 후 매니페스트에 워크플로우 목록과 메타데이터 기록
- 에러 발생 시에도 부분 백업 결과 유지 (continueOnError 패턴)
